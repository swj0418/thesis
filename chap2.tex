\chapter{Background}
  \section{Classic Acoustic Clutter Suppression Algorithms} % 2-3 pages
    \subsection{Tissue Harmonic Imaging}
      One widely-used approach to suppress cluttered reverberation signals is tissue harmonic imaging (THI). THI circumvents the inherent reverberation in the commonly used fundamental frequency ($f_{c}$) by adopting a higher frequency - the second harmonic frequency ($f_{hc}$). Because reverberation clutter primarily occurs at the fundamental frequency, reflected signals received at a second harmonic frequency are not subject to the same clutter \cite{christopher1997finite, ward1997nonlinear, averkiou1997nonlinear}. As a result, harmonic B-mode images have better quality with higher contrast, improved resolution, and less near-field artifact. However, the tradeoffs of higher frequency are higher attenuation\footnote{Attenuation is the loss of power (amplitude) as a wave travels through depth. In soft tissue, higher frequency exacerbates attenuation.} and lower amplitude which cause a loss in axial resolution \cite{muir1980prediction, starritt1986development, humphrey2000nonlinear, cobbold2006foundations, anvari2015primer}. In addition, the narrowed bandwidth (fewer frequencies) reduces axial resolution\footnote{Axial resolution is the measure of how close two scatters are along the depth dimension. Axial resolution is a function of pulse length as well as transducer frequency.} \cite{whittingham1999tissue}.

    \subsection{Time-Reversal Technique}
      Time-reversal is another method for suppressing reverberation clutter. In this method, ultrasound waves are transmitted and received twice. After the initial transmit and receive, the signals are reversed and re-transmitted into the field of view. The re-transmitted signals propagate back and refocus on the original source throughout the same medium, subject to the same reverberation. While clutter noises present differently for each transmit (incoherent), non-clutter signals follow the similar frequency patterns (coherent). This approach sums the original and the re-transmitted signals, amplifying signal and reduces reverberation clutter thanks to the constructive and destructive interference of waves depending on coherence. The limitation for this approach is its requirement for a point-like source in the medium as the focal region is difficult to determine \cite{dei_thesis, fink1992time}.

    \subsection{Second-Order Ultrasound Field}
      Second-order ultrasound field (SURF) is another method for suppressing reverberation clutter in images \cite{angelsen2007surf}. This application is specific to contrast-enhanced ultrasound (CEUS), where patients ingest contrast agents to typically in the form of microbubbles and by injection. The goal of CEUS is the detection of the contrast agent instead of tissues. SURF first transmits a low-frequency pulse that alters the scattering properties of the microbubbles. It then use a high-frequency pulse to detect the difference in scattering caused by the low-frequency pulse. This method effectively measures the true depth of the microbubbles while avoiding reverberation clutter in resulting imaes \cite{masoy2019surf}. The downside of using a high-frequency pulse for imaging is the existence of grating lobes \footnote{Strong side lobes.}, which in turn cause off-axis artifacts. Furthermore, SURF imaging only applies to CEUS and requires a specialized transducer array to emit dual-band waves \cite{dei_thesis}.

    \subsection{Short-Lag Spatial Coherence}
      Short-lag spatial coherence (SLSC) is a beamforming technique that takes advantage of the spatial similarity among the response waves across the aperture \cite{slsc}. Instead of summing across the channels as is the case in delay-and-sum (DAS) beamforming, SLSC measures - for each beam - the average correlation between all pairs of channels separated by \textit{l} ("lag") elements, for a given set of lags. The rationale behind this approach is that adjacent channel signals (short lags) are coherent spatially \footnote{Coherent means similar. Coherent waves have the same shape but are separated by a time delay. Coherence is a form of correlation or covariance between waves.}, but noises are incoherent. Weighted multiplication of waves would amplify the coherent components (the desired signals) and suppress the incoherent ones (the noises). As a result, the beaformed images show higher contrast, improved contrast-to-noise ratios, and better image texture \cite{dahl2017coherence}. The tradeoffs for these improvements include more computational complexity from additional matrix-based correlation derivation and loss in image resolution from only utilizing partial aperture information \cite{lediju2015resolution}. Moreover, the values in the image matrix are correlation measures instead of dB. Therefore, SLSC images are not directly comparable to B-mode images.

    \subsection{Coherence Factor}
      Coherence factor (CF) is a post-processing technique that computes a weight for each beam and each depth and applies these weights to the delay-and-sum (DAS) beamformed RF data \cite{mallart1994adaptive, hollman1999coherence}. Mathematically, the CF is the ratio of the sum of coherent signals over all signals in each beam. Similar to SLSC, CF takes advantage of the high-coherence property of non-clutter signals to suppress cluttered signals. Compared with SLSC, this method improves image contrast while avoiding introducting of high computational complexity \cite{dei_thesis}. % TODO: downside?

    \subsection{Minimum-Variance Beamforming}
      Minimum variance (MV) beamforming is an approach to suppress off-axis scattering. It does so by minimizing the power (the zero-mean variance) of off-axis regions, while preserving the power of the target region (a point location) \cite{synnevag2007adaptive, holfort2009broadband}. MV has proven effective in improving contrast in phantom targets. The drawback of MV is its sensitivity to the dB variation from inside the focal region. In addition, the image quality improvements do not translate to \textit{in vivo} images. %TODO find citatations for pros and cons.

\section{Machine Learning-Based Acoustic Clutter Suppression Algorithms}

\subsection{ADMIRE}

Aperture Domain Model Image Reconstruction (ADMIRE) is a model-based approach to suppress off-axis scattering and reverberation clutter. It operates on frequency-domain channel data, decomposes the cluttered signal, selects the scatterer in the region of interest (ROI), and reconstructs the decluttered signal. It then uses regression to determine the coefficient for regularizing each component signal. ADMIRE proves highly effective in suppressing both off-axis scattering and reverberation clutter. However, the computational complexity inherent in this approach precludes real-time applications until further optimization increases the frame rate \cite{dei_thesis, admire2015}.

\subsection{Beamforming Through Regularized Inverse Problems in Ultrasound Medical Imaging}
\cite{szasz_regularized_inverse}

\section{Deep Learning-Based Acoustic Clutter Suppression Algorithm} % 5-6 pages.

\subsection{Introduction to Neural Networks}

Neural networks are machine learning models that learn by backpropagating loss. They are theoretically able to learn a broad set of complex functions by taking advantage of nonlinear activations \cite{rumelhart1985learning}. Convolutional Neural Networks (CNNs) are special neural networks that take advantage of localized parameter sharing and convolutions. CNNs require fewer parameters and thus have a reduced risk of overfitting. CNNs have seen widespread applications in Computer Vision, Natural Language Processing, and Medical Imaging alike. LeNet was an influential CNN architecture for classifying images. It consisted of two convolutional layers followed by two fully-connected layers. Each convolutional layer was accompanied by a pooling layer for down-sampling. It was used to successfully recognize handwritten digits \cite{lenet}.

Training neural networks involves selecting training hyperparameters such as learning rate, dropout rate, and the width of fully-connected layers. Recent studies show that random search is more effective than grid search in finding the optimal neural network \cite{bergstra2012random}. Furthermore, as there are no established models for ultrasound beamforming, a random search for "hyperparameters" in model arhitecture, such as the kernel dimensions, the number of kernels, and the padding/stride dimensions for a convolutional layer is necessary.

% \subsection{Random Hyperparameter Search}

\subsection{Multi-Layer Perceptrons for Suppressing Off-Axis Scattering}

Luchies and Byram proposed a neural-network approach to suppress off-axis scattering \cite{luchies_tmi_2018, training_improvements}. They trained multi-layer perceptrons (MLPs) that operated on the frequency domain to suppress the off-axis signals based on simulated point targets. They prove effective in improving contrast while preserving speckle patterns. This work motivates further exploration of convolutional neural networks on the same STFT-domain data, as there may be spatial features in the frequency domain that could be more effectively learned by CNNs.

\subsection{Convolutional Neural Networks for Noise Reduction}

Although no CNN-based approaches have been proposed for reducing off-axis scattering and reverberation clutter, there are related approaches for learning ultrasound reconstruction and speckle reduction. For example, Yoon et al. proposed a method that effectively interpolates missing sub-sampled RF data in 3D ultrasound \cite{yoon2018efficient}. Hyun et al. showed that fully-connected neural networks have the potential to learn the beamforming process \cite{hyun2019beamforming}, albeit with limited effectiveness.

% \subsection{Convolutional Neural Networks for Noise Reduction}
%
%  % Figure ? shows the architecture and hyperparameters of the original AlexNet.
%
% AlexNet was another important architecture. Deeper than LeNet, it featured five convolutional layers. It was the first CNN to beat domain-specific methods to classify images in the ImageNet competition. To this day, AlexNet is still considered a reference architecture. % Figure ? and table ? illustrate the model and its hyperparameters.
%
% By applying CNNs to the same STFT data, we introduce convolution to the aperture dimension as well. CNNs could have the additional benefit of detecting local features such as aperture shapes. In addition, CNN beamformers, with fewer parameters, may be easier to train as shown in other application domains.


% \subsection{CNNs in Denoising and Regression}
% Motivate why CNNs. Fully-connected layers in general. Why would they not be appropriate

% \subsection{CNN Architectures to address}
% U-Net is a segmentation problem. Fully-Convolutional Neural Networks. Bottlenecks.

% TODO: find cnns for denoising/regression.




% Recently, deep neural networks have been used for ultrasound beamforming by our group [cite] and others [cite] [cite]. Our method applies deep neural network beamforming in the short-time Fourier transform (STFT) domain in order to avoid having to train for different pulse shapes, depth dependent attenuation, and other pulse parameters that may vary across patients and even across probes as they age. Our early approach used classic fully connected deep networks (FCNs) trained with synthetic data. These beamformers are convolutional in nature insofar as the networks, including their weights, are reused through depth; however, fully connected layers are used to span the aperture dimension. We demonstrated that these models could work well [cite].
